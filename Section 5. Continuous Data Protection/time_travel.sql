CREATE DATABASE timetravel_demo;
USE DATABASE timetravel_demo;

CREATE TABLE STORE
AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE;

SELECT COUNT(*) FROM STORE;


-- Use Timestamp in Time Travel
--2024-07-19 10:54:58.206 -0700
SELECT CURRENT_TIMESTAMP;

UPDATE STORE SET s_manager = NULL;

SELECT * FROM STORE
BEFORE (TIMESTAMP => '2024-07-19 10:54:58.206 -0700'::timestamp_ltz);

SELECT * FROM STORE
AT (TIMESTAMP => '2024-07-19 10:54:58.206 -0700'::timestamp_ltz);


-- Query ID: 01b5c71d-0000-fc73-0000-0001c0e6be25
DELETE FROM STORE;

SELECT COUNT(*) FROM STORE;  -- 0

SELECT * FROM STORE
BEFORE(STATEMENT => '01b5c71d-0000-fc73-0000-0001c0e6be25');


SELECT * FROM STORE
AT(STATEMENT => '01b5c71d-0000-fc73-0000-0001c0e6be25');


-- OFFSET from the current timestamp
SELECT * FROM STORE
AT(OFFSET => -1000)